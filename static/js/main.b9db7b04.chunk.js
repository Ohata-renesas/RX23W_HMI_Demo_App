(this.webpackJsonprx23w_hmi_demo_app=this.webpackJsonprx23w_hmi_demo_app||[]).push([[0],{72:function(e,t,n){e.exports=n(83)},77:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),i=(n(77),n(26)),l=n(47),s=n(16),u=n(29),m=n(133),d=n(131),f=n(130),h=n(123),v=n(137),g=n(139),b=n(129),p=n(125),E=n(141),I=n(126),w=n(60),y=n.n(w),k=n(132),R=n(48),C=n(140),N=n(142),O=n(134),S=n(58),x=n.n(S),V=n(59),j=n.n(V),D=n(127),U=n(128),T=n(138),P=n(121),W=n(12),G=n(56),B=n(57),L=new(function(){function e(){Object(G.a)(this,e),this.bleInfo={deviceName:"RBLE-DEV",device:null,server:null,onDisconnectedHandler:null,serviceInfo:{uuid:"65bcbd70-7952-439b-80b5-a5e8c4de44b0",service:null},characteristicInfo:{voiceRecogResult:{uuid:"0c71cedc-c090-4021-80a1-95c4b3215be8",characteristic:null,handler:null},voiceRecogInfo:{uuid:"3ea2a6d7-bf5a-4841-870a-5df9c34895d9",characteristic:null},voiceRecogParams:{uuid:"c609788e-2f87-4ac8-b622-99e77287ca3c",characteristic:null},ledControl:{uuid:"c1f878d3-ff13-4a18-9b4d-058942171f8d",characteristic:null},envSensor:{uuid:"bcabfa13-a223-4715-a72e-60067b5a1537",characteristic:null,handler:null}}},this.options={filters:[{services:[this.bleInfo.serviceInfo.uuid]},{name:this.bleInfo.deviceName}]}}return Object(B.a)(e,[{key:"connectDevice",value:function(e,t,n){var a=this;return t?e?this.connectServer(e,n):this.requestDevice(t).then((function(e){return a.connectServer(e,n)})):(console.log("No options"),Promise.resolve())}},{key:"requestDevice",value:function(e){return e?(console.log("Request the device"),navigator.bluetooth.requestDevice(e)):(console.log("No options"),Promise.resolve())}},{key:"connectServer",value:function(e,t){return e&&t?(this.bleInfo.device=e,this.bleInfo.onDisconnectedHandler=t,this.bleInfo.device.addEventListener("gattserverdisconnected",t),console.log("Connect the GATT server"),e.gatt.connect()):(console.log("No device or handler"),Promise.resolve())}},{key:"getService",value:function(e,t){return e&&t?(this.bleInfo.server=e,console.log("Get the service"),e.getPrimaryService(t)):(console.log("No server"),Promise.resolve())}},{key:"getCharacteristics",value:function(e){return e?(this.bleInfo.serviceInfo.service=e,console.log("Get characteristics"),e.getCharacteristics()):(console.log("No service"),Promise.resolve())}},{key:"getCharacteristic",value:function(e,t){return e&&t?(this.bleInfo.serviceInfo.service=e,console.log("Get characteristic"),e.getCharacteristic(t)):(console.log("No service or uuid"),Promise.resolve())}},{key:"setCharacteristic",value:function(e){var t=this;return e?(e.forEach((function(e){switch(e.uuid){case t.bleInfo.characteristicInfo.voiceRecogResult.uuid:t.bleInfo.characteristicInfo.voiceRecogResult.characteristic=e;break;case t.bleInfo.characteristicInfo.voiceRecogInfo.uuid:t.bleInfo.characteristicInfo.voiceRecogInfo.characteristic=e;break;case t.bleInfo.characteristicInfo.voiceRecogParams.uuid:t.bleInfo.characteristicInfo.voiceRecogParams.characteristic=e;break;case t.bleInfo.characteristicInfo.ledControl.uuid:t.bleInfo.characteristicInfo.ledControl.characteristic=e;break;case t.bleInfo.characteristicInfo.envSensor.uuid:t.bleInfo.characteristicInfo.envSensor.characteristic=e}})),Promise.resolve()):(console.log("No characteristics"),Promise.resolve())}},{key:"readValue",value:function(e){return e?(console.log("Read value"),e.readValue()):(console.log("No characteristic"),Promise.resolve())}},{key:"writeValueWithoutResponse",value:function(e,t,n){if(t&&n){if(e.gatt.connected){var a=new Uint8Array(n);return console.log("Write value without response"),t.writeValueWithoutResponse(a)}console.log("No connection")}else console.log("No characteristic or value")}},{key:"startNotifications",value:function(e,t){return e&&t?(e.handler=t,e.characteristic.addEventListener("characteristicvaluechanged",t),e.characteristic.startNotifications()):(console.log("No characteristic or handler"),Promise.resolve())}},{key:"disconnect",value:function(e){return e?e.gatt.connected?(console.log("Disconnect device"),e.gatt.disconnect()):void console.log("Disconeected : No connection"):void console.log("No device")}}]),e}()),_=Object(P.a)((function(e){return{boxWrapper:{width:"100%",height:"100%"},typography:{fontSize:"100%"}}}));function z(e){_(),window.innerWidth,window.innerHeight;return r.a.createElement("div",null,r.a.createElement(R.a,{style:{color:"#333333",fontSize:"200%"}},"Voice Recognition Result"))}var A=n(124),H=n(136);function q(e){return r.a.createElement("div",null,r.a.createElement(M,{name:"TEMP",unit:"\xb0C",currentValue:e.sensorData.temperature,maxValue:125,minValue:-40}),r.a.createElement(h.a,null),r.a.createElement(M,{name:"HUMI",unit:"%RH",currentValue:e.sensorData.humidity,maxValue:100,minValue:0}),r.a.createElement(h.a,null),r.a.createElement(M,{name:"CO2",unit:"ppm",currentValue:e.sensorData.co2,maxValue:1e4,minValue:0}),r.a.createElement(h.a,null),r.a.createElement(M,{name:"TVOC",unit:"mg/m3",currentValue:e.sensorData.tvoc,maxValue:50,minValue:0}),r.a.createElement(h.a,null),r.a.createElement(M,{name:"IAQ",unit:"",currentValue:e.sensorData.iaq,maxValue:50,minValue:0}))}function M(e){var t=r.a.useState(0),n=Object(s.a)(t,2),a=n[0],o=n[1],c=r.a.useRef(null),i=r.a.useRef("0%"),l=r.a.useRef(e.currentValue);return r.a.useEffect((function(){return c.current=setTimeout((function(){var t=(e.currentValue-e.minValue)/(e.maxValue-e.minValue)*100;l.current=e.currentValue,i.current=.9*t+"%",o(t)}),500),function(){c.current&&clearTimeout(c.current),c.current=null}})),r.a.createElement(H.a,{display:"flex",flexDirection:"row",width:"100%",mt:1,mb:2},r.a.createElement(H.a,{minWidth:80,mt:1.5},r.a.createElement(R.a,{style:{fontSize:"200%"},color:"secondary"},e.name)),r.a.createElement(H.a,{width:"100%",ml:2,mr:"35px"},r.a.createElement(H.a,{display:"flex",flexDirection:"row",textAlign:"center"},r.a.createElement(H.a,{ml:i.current},r.a.createElement(R.a,{style:{fontSize:"200%",fontWeight:"bold"},color:"primary"},l.current)),r.a.createElement(H.a,{mt:2.2},r.a.createElement(R.a,{style:{fontSize:"80%",fontWeight:"bold"},color:"secondary"},e.unit))),r.a.createElement(H.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.a.createElement(H.a,null,r.a.createElement(R.a,{color:"textSecondary",style:{fontSize:"80%",fontWeight:"bold"}},e.minValue)),r.a.createElement(H.a,{width:"100%",mr:1,ml:1},r.a.createElement(A.a,{variant:"determinate",value:a})),r.a.createElement(H.a,{minWidth:35},r.a.createElement(R.a,{color:"textSecondary",style:{fontSize:"80%",fontWeight:"bold"}},e.maxValue)))))}var F="Voice Detection Threshold",J=Object(P.a)((function(e){return{root:{display:"flex"},drawer:Object(u.a)({},e.breakpoints.up("sm"),{width:200,flexShrink:0}),appBar:Object(u.a)({},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(200,"px)"),marginLeft:200}),title:{flexGrow:1,color:"white"},menuButton:Object(u.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:200},content:{flexGrow:1,padding:e.spacing(2)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#333333"},nested:{paddingLeft:e.spacing(4)}}}));function Q(e){var t=e.currentPage,n=e.wordInfo,a=e.voiceRecogResult,o=e.sensorData;switch(t){case"V/R Result":return r.a.createElement(z,{wordInfo:n,voiceRecogResult:a});case"Confidence Threshold":return r.a.createElement("div",null,r.a.createElement(R.a,null,"Confidence Threshold"));case F:return r.a.createElement("div",null,r.a.createElement(R.a,null,"Vocie Detection Threshold"));case"Gain":return r.a.createElement("div",null,r.a.createElement(R.a,null,"Gain"));case"Noise Suppressor":return r.a.createElement("div",null,r.a.createElement(R.a,null,"Noise Suppressor"));case"Beam Forming":return r.a.createElement("div",null,r.a.createElement(R.a,null,"Beam Forming"));case"Indoor Environment":return r.a.createElement("div",null,r.a.createElement(q,{sensorData:o}));case"Instructions":return r.a.createElement("div",null,r.a.createElement(R.a,null,"Instructions"));default:return r.a.createElement("div",null,r.a.createElement(R.a,null,"Error"))}}var X=function(e){var t,n=e.window,o=J(),c=Object(W.a)(),u=Object(a.useRef)(10),w=Object(a.useRef)(null),S=Object(a.useRef)([]),V=Object(a.useRef)(0),P=r.a.useState(!1),G=Object(s.a)(P,2),B=G[0],_=G[1],z=r.a.useState(!1),A=Object(s.a)(z,2),H=A[0],q=A[1],M=r.a.useState("CONNECT"),X=Object(s.a)(M,2),$=X[0],K=X[1],Y=r.a.useState({open:!0,vertical:"bottom",horizontal:"center",message:'Please click or tap "CONNECT" on the top-right',autoHideDuration:5e3}),Z=Object(s.a)(Y,2),ee=Z[0],te=Z[1],ne=r.a.useState([]),ae=Object(s.a)(ne,2),re=ae[0],oe=ae[1],ce=r.a.useState({temperature:0,humidity:0,co2:0,tvoc:0,iaq:0}),ie=Object(s.a)(ce,2),le=ie[0],se=ie[1],ue=r.a.useState({wordId:0,status:0,score:0}),me=Object(s.a)(ue,2),de=me[0],fe=me[1],he=r.a.useState("V/R Result"),ve=Object(s.a)(he,2),ge=ve[0],be=ve[1],pe=r.a.useState(!1),Ee=Object(s.a)(pe,2),Ie=Ee[0],we=Ee[1],ye=r.a.useState(!1),ke=Object(s.a)(ye,2),Re=ke[0],Ce=ke[1],Ne=r.a.useState([]),Oe=Object(s.a)(Ne,2),Se=Oe[0],xe=Oe[1],Ve=function(e){te(Object(i.a)(Object(i.a)({},ee),{},{open:!0,message:e}))},je=function(){_(!B)},De=function e(){V.current?(q(!0),V.current=0,K("CONNECT"),L.disconnect(L.bleInfo.device),q(!1),Ve("The device is disconnected")):(V.current=1,S.current=[],q(!0),L.connectDevice(L.bleInfo.device,L.options,Ue).then((function(e){return we(!0),Ve("Get the service"),L.getService(e,L.bleInfo.serviceInfo.uuid)})).then((function(e){return Ve("Get the characteristic"),L.getCharacteristics(e)})).then((function(e){return L.setCharacteristic(e)})).then((function(e){return Ve("Get Voice Recognition Information"),We()})).then((function(e){return Ve("Start notification"),L.startNotifications(L.bleInfo.characteristicInfo.voiceRecogResult,Te)})).then((function(e){return L.startNotifications(L.bleInfo.characteristicInfo.envSensor,Pe)})).then((function(e){w.current&&clearTimeout(w.current),u.current=10,w.current=null,V.current=1,we(!1),q(!1),Ve("Measurement is started"),K("DISCONNECT")})).catch((function(t){V.current=0,Ve(""+t),console.log(t),L.bleInfo.device?(w.current=setTimeout(e,1e4),Ve("Reconnection countdown: "+u.current),console.log("Reconnection countdown: "+u.current),u.current>0?u.current--:(w.current&&clearTimeout(w.current),u.current=10,w.current=null,we(!1),q(!1),Ve("Cannot connect device..."),console.log("Cannot connect device..."))):(K("CONNECT"),q(!1))})))},Ue=function(){V.current?(V.current=0,console.log("unexpected disconnection"),De()):V.current=0},Te=function(e){var t=e.target.value,n={};n.wordId=t.getUint8(0),n.status=t.getUint8(1),n.score=t.getUint8(2),console.log("Word ID : "+n.wordId),console.log("Result : "+n.status),console.log("Score : "+n.score),fe(Object(i.a)({},n))},Pe=function(e){var t=e.target.value,n=t.getUint8(0),a={};a.temperature=1===n?-1*(t.getUint8(1)+.01*t.getUint8(2)):t.getUint8(1)+.01*t.getUint8(2),a.humidity=(t.getUint8(3)<<8)+t.getUint8(4)+.01*t.getUint8(5),a.co2=(t.getUint8(6)<<8)+t.getUint8(7)+.01*t.getUint8(8),a.tvoc=(t.getUint8(9)<<8)+t.getUint8(10)+.01*t.getUint8(11),a.iaq=(t.getUint8(12)<<8)+t.getUint8(13)+.01*t.getUint8(14),console.log("Temperature : "+a.temperature),console.log("Humidity : "+a.humidity),console.log("CO2 : "+a.co2),console.log("TVOC : "+a.tvoc),console.log("IAQ : "+a.iaq),se(Object(i.a)({},a))},We=function e(){return L.readValue(L.bleInfo.characteristicInfo.voiceRecogInfo.characteristic).then((function(t){var n={};n.status=t.getUint8(0),n.cf=t.getUint8(1),n.vd=(t.getUint8(2)<<8)+t.getUint8(3),n.gain=t.getUint8(4),n.ns=t.getUint8(5),n.bf=t.getUint8(6),n.wordId=t.getUint8(7),n.length=t.getUint8(8);var a=t.buffer.slice(9,n.length-1+9),r=new TextDecoder("utf-8"),o=new Uint8Array(a);return n.text=r.decode(o),console.log(n.text),S.current=[].concat(Object(l.a)(S.current),[n]),1===n.status?e():0===n.status?(oe(Object(l.a)(S.current)),Promise.resolve()):void 0}))},Ge=function(e){be(e)},Be=r.a.createElement("div",null,r.a.createElement("div",{className:o.toolbar}),r.a.createElement(h.a,null),r.a.createElement(p.a,null,r.a.createElement(E.a,{button:!0,key:"V/R Result",onClick:function(){return Ge("V/R Result")}},r.a.createElement(I.a,{primary:"V/R Result"})),r.a.createElement(E.a,{button:!0,key:"V/R Settings",onClick:function(){Ce(!Re)}},r.a.createElement(I.a,{primary:"V/R Settings"}),Re?r.a.createElement(x.a,null):r.a.createElement(j.a,null)),r.a.createElement(D.a,{in:Re,timeout:"auto",unmountOnExit:!0},r.a.createElement(p.a,{component:"div",disablePadding:!0},r.a.createElement(E.a,{button:!0,className:o.nested,key:"Confidence Threshold",onClick:function(){return Ge("Confidence Threshold")}},r.a.createElement(I.a,{primary:"Confidence Threshold"})),r.a.createElement(E.a,{button:!0,className:o.nested,key:F,onClick:function(){return Ge(F)}},r.a.createElement(I.a,{primary:F})),r.a.createElement(E.a,{button:!0,className:o.nested,key:"Gain",onClick:function(){return Ge("Gain")}},r.a.createElement(I.a,{primary:"Gain"})),r.a.createElement(E.a,{button:!0,className:o.nested,key:"Noise Suppressor",onClick:function(){return Ge("Noise Suppressor")}},r.a.createElement(I.a,{primary:"Noise Suppressor"})),r.a.createElement(E.a,{button:!0,className:o.nested,key:"Beam Forming",onClick:function(){return Ge("Beam Forming")}},r.a.createElement(I.a,{primary:"Beam Forming"})))),r.a.createElement(E.a,{button:!0,key:"Indoor Environment",onClick:function(){return Ge("Indoor Environment")}},r.a.createElement(I.a,{primary:"Indoor Environment"})),r.a.createElement(E.a,null,r.a.createElement(I.a,{key:"LED Control",primary:"LED Control"}),r.a.createElement(U.a,null,r.a.createElement(T.a,{edge:"end",onChange:(t="LED Control",function(){var e=Se.indexOf(t),n=Object(l.a)(Se);-1===e?(n.push(t),L.writeValueWithoutResponse(L.bleInfo.device,L.bleInfo.characteristicInfo.ledControl.characteristic,[1])):(n.splice(e,1),L.writeValueWithoutResponse(L.bleInfo.device,L.bleInfo.characteristicInfo.ledControl.characteristic,[0])),xe(n)}),checked:-1!==Se.indexOf("LED Control"),inputProps:{"aria-labelledby":"LED Control"},color:"primary"})))),r.a.createElement(h.a,null),r.a.createElement(p.a,null,r.a.createElement(E.a,{button:!0,key:"Instructions",onClick:function(){return Ge("Instructions")}},r.a.createElement(I.a,{primary:"Instructions"})))),Le=void 0!==n?function(){return n().document.body}:void 0;return r.a.createElement("div",{className:o.root},r.a.createElement(f.a,null),r.a.createElement(d.a,{position:"fixed",className:o.appBar},r.a.createElement(k.a,null,r.a.createElement(b.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:je,className:o.menuButton,style:{color:"white"}},r.a.createElement(y.a,null)),r.a.createElement(R.a,{className:o.title,variant:"h6",noWrap:!0},"RX23W HMI DEMO"),r.a.createElement(m.a,{color:"inherit",style:{color:"white"},disabled:Boolean(H),onClick:De},$))),r.a.createElement("nav",{className:o.drawer,"aria-label":"mailbox folders"},r.a.createElement(g.a,{smUp:!0,implementation:"css"},r.a.createElement(v.a,{container:Le,variant:"temporary",anchor:"rtl"===c.direction?"right":"left",open:B,onClose:je,classes:{paper:o.drawerPaper},ModalProps:{keepMounted:!0}},Be)),r.a.createElement(g.a,{xsDown:!0,implementation:"css"},r.a.createElement(v.a,{classes:{paper:o.drawerPaper},variant:"permanent",open:!0},Be))),r.a.createElement("main",{className:o.content},r.a.createElement("div",{className:o.toolbar}),r.a.createElement(Q,{currentPage:ge,wordInfo:re,voiceRecogResult:de,sensorData:le})),r.a.createElement(C.a,{open:ee.open,onClose:function(){te(Object(i.a)(Object(i.a)({},ee),{},{open:!1}))},message:ee.message,key:ee.vertical+ee.horizontal,autoHideDuration:ee.autoHideDuration}),r.a.createElement(N.a,{className:o.backdrop,open:Ie},r.a.createElement(O.a,{color:"inherit"})))},$=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function K(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Y=n(61),Z=n(135),ee=Object(Y.a)({palette:{primary:{light:"#5453b0",main:"#2a289d",dark:"#1d1c6d",contrastText:"#000000"},secondary:{light:"#5b5b5b",main:"#333333",dark:"#232323",contrastText:"#000000"}}});c.a.render(r.a.createElement(Z.a,{theme:ee},r.a.createElement(X,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rx23w_hmi_demo_app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rx23w_hmi_demo_app","/service-worker.js");$?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):K(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):K(t,e)}))}}()}},[[72,1,2]]]);
//# sourceMappingURL=main.b9db7b04.chunk.js.map