(this.webpackJsonprx23w_hmi_demo_app=this.webpackJsonprx23w_hmi_demo_app||[]).push([[0],{10:function(e,t,o){e.exports=o(16)},15:function(e,t,o){},16:function(e,t,o){"use strict";o.r(t);var n=o(0),i=o.n(n),c=o(9),r=o.n(c),a=(o(15),o(4)),s=o(7),l=o(2),u=o(3),d=o(1),g=o(6),h=o(5),v={voiceRecogResult:{uuid:"0c71cedc-c090-4021-80a1-95c4b3215be8",characteristic:null},voiceRecogInfo:{uuid:"3ea2a6d7-bf5a-4841-870a-5df9c34895d9",characteristic:null},voiceRecogParams:{uuid:"c609788e-2f87-4ac8-b622-99e77287ca3c",characteristic:null},ledControl:{uuid:"c1f878d3-ff13-4a18-9b4d-058942171f8d",characteristic:null},envSensor:{uuid:"bcabfa13-a223-4715-a72e-60067b5a1537",characteristic:null}},f={filters:[{services:["65bcbd70-7952-439b-80b5-a5e8c4de44b0"]},{name:"RBLE-DEV"}]},b=function(e){Object(g.a)(o,e);var t=Object(h.a)(o);function o(e){var n;return Object(l.a)(this,o),(n=t.call(this,e)).device=null,n.server=null,n.service=null,n.characteristics=null,n.connectionStatus=0,n.wordInfo=[],n.onClick=n.onClick.bind(Object(d.a)(n)),n}return Object(u.a)(o,[{key:"connect",value:function(){var e=this;return this.requestDevice().then((function(t){return e.server=t,console.log("Get the server"),t.getPrimaryService("65bcbd70-7952-439b-80b5-a5e8c4de44b0")})).then((function(t){return e.service=t,console.log("Get the service"),t.getCharacteristics()})).then((function(t){return console.log("Get the characteristics"),t.forEach((function(e){switch(e.uuid){case v.voiceRecogResult.uuid:v.voiceRecogResult.characteristic=e,console.log("Get Voice Recognition Result Characteristic");break;case v.voiceRecogInfo.uuid:v.voiceRecogInfo.characteristic=e,console.log("Get Voice Recognition Information Characteristic");break;case v.voiceRecogParams.uuid:v.voiceRecogParams.characteristic=e,console.log("Get Voice Recognition Parameters Characteristic");break;case v.ledControl.uuid:v.ledControl.characteristic=e,console.log("Get LED Control Characteristic");break;case v.envSensor.uuid:v.envSensor.characteristic=e,console.log("Get Environmental Sensor Characteristic")}})),e.readVoiceRecognitionInformation(v.voiceRecogInfo.characteristic)})).then((function(t){return console.log("Start Write LED LEVEL"),e.writeWithoutResponse(v.ledControl.characteristic,[1])})).then((function(t){return console.log("Start notification of voice recognition result"),v.voiceRecogResult.characteristic.addEventListener("characteristicvaluechanged",e.props.handleVoiceRecognitionResult),v.voiceRecogResult.characteristic.startNotifications()})).then((function(t){return console.log("Start notification of environmental sensor"),v.envSensor.characteristic.addEventListener("characteristicvaluechanged",e.props.handleEnvironmentalSensor),v.envSensor.characteristic.startNotifications()})).catch((function(e){console.log(e)}))}},{key:"requestDevice",value:function(){var e=this;return this.device?(console.log("Use the device information that I already have"),this.device.gatt.connect()):(console.log("Request the device"),navigator.bluetooth.requestDevice(f).then((function(t){return e.device=t,e.device.addEventListener("gattserverdisconnected",e.onDisconnected),t.gatt.connect()})))}},{key:"onDisconnected",value:function(){}},{key:"writeValueWithoutResponse",value:function(e,t){}},{key:"readVoiceRecognitionInformation",value:function(e){var t=this;if(e)return console.log("Get value of voice recognition information"),e.readValue().then((function(o){var n={};console.log(o),n.status=o.getUint8(0),n.cf=o.getUint8(1),n.vd=(o.getUint8(2)<<8)+o.getUint8(3),n.gain=o.getUint8(4),n.ns=o.getUint8(5),n.bf=o.getUint8(6),n.wordId=o.getUint8(7),n.length=o.getUint8(8);var i=o.buffer.slice(9,9+n.length),c=new TextDecoder("utf-8"),r=new Uint8Array(i);return n.word=c.decode(r),t.wordInfo=[].concat(Object(a.a)(t.wordInfo),[n]),1===n.status?console.log("Status : Is in progress"):console.log("Status : Is finished"),console.log("Parameters"),console.log("Confidence Threshold : "+n.cf),console.log("Voice Detection Threshold : "+n.vd),console.log("Gain : "+n.gain),console.log("Noise Suppressor : "+n.ns),console.log("Beam Forming : "+n.bf),console.log("Word Id : "+n.wordId),console.log("length : "+n.length),console.log("Word : "+n.word),1===n.status?t.readVoiceRecognitionInformation(e):(t.props.getWordInfo(t.wordInfo),Promise.resolve())}));console.log("No characteristic")}},{key:"writeWithoutResponse",value:function(e,t){if(this.device){if(this.device.gatt.connected){var o=new Uint8Array(t);return console.log("write: "+o),e.writeValueWithoutResponse(o)}console.log("Error : No connect")}else console.log("Error : No Bluetooth Device")}},{key:"parseVoiceRecognitionResult",value:function(e){var t={};return t.wordId=e.getUint8(0),t.status=e.getUint8(1),t.score=e.getUint8(2),t}},{key:"parseSensorData",value:function(e){var t,o={};return t=e.getUint8(0),o.temperature=e.getUint8(1)+.01*e.getUint8(2),1===t&&(o.temperature*=-1),o.humidity=(e.getUint8(3)<<8)+e.getUint8(4)+.01*e.getUint8(5),o.co2=(e.getUint8(6)<<8)+e.getUint8(7)+.01*e.getUint8(8),o.tvoc=(e.getUint8(9)<<8)+e.getUint8(10)+.01*e.getUint8(11),o.iaq=(e.getUint8(12)<<8)+e.getUint8(13)+.01*e.getUint8(14),o}},{key:"onClick",value:function(){this.connect()}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("button",{style:{width:200,height:100,backgroundColor:"#3F51B5",color:"rgba(255,255,255,.87)",border:"none",borderRadius:20,fontSize:36,fontWeight:"bold"},onClick:this.onClick},"Connect"))}}]),o}(i.a.Component),m=function(e){Object(g.a)(o,e);var t=Object(h.a)(o);function o(e){var n;return Object(l.a)(this,o),(n=t.call(this,e)).state={wordInfo:[],voiceRecogData:{},sensorData:{}},n.bleDevice=new b,n.handleVoiceRecognitionResult=n.handleVoiceRecognitionResult.bind(Object(d.a)(n)),n.handleEnvironmentalSensor=n.handleEnvironmentalSensor.bind(Object(d.a)(n)),n.getWordInfo=n.getWordInfo.bind(Object(d.a)(n)),n}return Object(u.a)(o,[{key:"shouldComponentUpdate",value:function(e,t){return!0}},{key:"handleVoiceRecognitionResult",value:function(e){var t=this.bleDevice.parseVoiceRecognitionResult(e.target.value);console.log("Word ID : "+t.wordId),console.log("Result : "+t.status),console.log("Score : "+t.score),this.setState({voiceRecogData:Object(s.a)({},t)})}},{key:"handleEnvironmentalSensor",value:function(e){var t=this.bleDevice.parseSensorData(e.target.value);console.log("Temperature : "+t.temperature),console.log("Humidity : "+t.humidity),console.log("CO2 : "+t.co2),console.log("TVOC : "+t.tvoc),console.log("IAQ : "+t.iaq),this.setState({sensorData:Object(s.a)({},t)})}},{key:"getWordInfo",value:function(e){this.setState({wordInfo:Object(a.a)(e)}),console.log(this.state.wordInfo)}},{key:"render",value:function(){console.log("render");var e,t=this.state.wordInfo[0];return e=t?i.a.createElement("div",null,"word[0]: ",t.word.slice(0,-1)):i.a.createElement("div",null,"word[0]: No text"),i.a.createElement("div",null,i.a.createElement(b,{handleVoiceRecognitionResult:this.handleVoiceRecognitionResult,handleEnvironmentalSensor:this.handleEnvironmentalSensor,getWordInfo:this.getWordInfo}),e,i.a.createElement("div",null,"temperature: ",this.state.sensorData.temperature),i.a.createElement("div",null,"status: ",this.state.voiceRecogData.status))}}]),o}(i.a.Component),w=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function p(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var o=e.installing;null!=o&&(o.onstatechange=function(){"installed"===o.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(m,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rx23w_hmi_demo_app",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rx23w_hmi_demo_app","/service-worker.js");w?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(o){var n=o.headers.get("content-type");404===o.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):p(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):p(t,e)}))}}()}},[[10,1,2]]]);
//# sourceMappingURL=main.1d05e015.chunk.js.map